define(["require","jquery","ext/mustache/0.7.3/mustache"],function(a,b,c){function f(c,f,g){f=f||a;var h={url:f.toUrl(c+"?jstemplate=html"),dataType:"jsonp",cache:!0,jsonpCallback:e(c),success:function(a){a.error?g(!1):g(new d(a.html||a))},error:function(){g(!1)}};c.indexOf(".tmpl")==c.length-5&&(h.dataType="text",delete h.jsonpCallback),b.ajax(h)}function e(a){var b="vproTmplCallback"+a.replace(/[^a-zA-Z0-9]/ig,""),c=1;while(typeof window[b]=="function")b+=""+c,c++;window[b]=function(){};return b}var d=function(a){this.html=a};d.prototype.render=function(a,b){return a?c.to_html(this.html,a,b):this.html};return{load:function(a,b,c,d){f(a,b,c)},process:function(b,c){f(b,a,c)},parse:function(a){return new d(a)}}})